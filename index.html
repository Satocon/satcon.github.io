<!DOCTYPE html>
  <head>
    <title>桃鉄カード売り場</title>
    <meta charset="utf-8">
    <link rel="icon" type="image/x-icon" href="./favicon.png">
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <py-env>
      - pandas
      - folium
      - paths:
            - hoshitobi.png
            - fukubukuro.png
            - tono.png
            - ushi.png
            - gs.png
            - blue.png 
            - kikyu.png
            - plane.png
            - ball.png
            - unchi.png
            - heri.png
            - yellow.png
            - katana.png
    </py-env>   
  </head>

  <body>
    <div id="folium" style="width: 100%; height: 100%; background-color:#ccc"></div>
      <py-script output="folium">

import pandas as pd
import folium

from pyodide.http import open_url
from folium.features import DivIcon
from folium.features import CustomIcon

<!--スプレッドシートを読み込む(スプレッドシートのアクセス権を変更すること！)-->
sheet_url = ("https://docs.google.com/spreadsheets/d/1bG-512BNgFMSKzmBdVZEBzcyc8QsW3k-kOxe85OZE0U/export?format=csv&gid=0")

url_content = open_url(sheet_url)
store_lists = pd.read_csv(url_content)

<!--マップを描く-->

<!--ここからマップを描く。最初にマップの中心地点と拡大要素を指定しておく-->
m = folium.Map(location=[8.384535865452674, 20.64648465722097], zoom_start=2.1)


<!--スプレッドシートの情報を1行ずつ読み込む-->
for index, row in store_lists.iterrows():
  
  <!--円を描いて色を塗る-->
  folium.Circle(
    location= [row['緯度'],row['経度']],
    radius=10,
    color=row['色'],
    fill_color=row['色'],
    fill=True,  
  ).add_to(m)

  <!--アイコン追加-->  
  folium.Marker(
    location= [row['緯度'],row['経度']],
    icon=CustomIcon(icon_image=row['アイコン'],
      icon_size=(25,25),
      icon_anchor=(10,10),
      popup_anchor=(0,0)),
  ).add_to(m)
  <!--駅名を表示する-->  
  folium.map.Marker(
    location= [row['緯度'],row['経度']],
    icon=DivIcon(
      icon_size=(100,20),
      icon_anchor=(-10,0),
      html=row['駅名'],),
    tooltip=row['カード1']+ "\r\n" + row['カード2']+ "\r\n" + row['カード3']+ "\r\n" + row['カード4']+ "\r\n" + row['カード5']+ "\r\n" + row['カード6']+ "\r\n" + row['カード7']+ "\r\n" + row['カード8'],    
  ).add_to(m)

  
folium.LayerControl().add_to(m)

m


      </py-script>    
  </body>
</html>
